<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
					   xmlns:s="library://ns.adobe.com/flex/spark" 
					   xmlns:mx="library://ns.adobe.com/flex/mx">
	<fx:Declarations>
		<!-- 非ビジュアルエレメント (サービス、値オブジェクトなど) をここに配置 -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import com.chocbanana.win.OE_Files;
			import com.chocbanana.win.OutlookExpressExtension;
			
			import mx.collections.ArrayCollection;

			private var ane:OutlookExpressExtension = new OutlookExpressExtension();
			
			[Bindable]
			private var ar:ArrayCollection = new ArrayCollection();
			
			protected function btn_getOEInfo_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				var files:Array = ane.getOE_Info();
				
				ar.removeAll();
				
				for(var i:int=0; i<files.length; i++){
					var item: OE_Files = files[i] as OE_Files;
					ar.addItem(item.fileName + " / " + item.fileSize);
				}
			}
			
		]]>
	</fx:Script>
	<s:Panel x="0" y="0" width="100%" height="100%" title="OutlookExpress情報">
		<s:VGroup width="100%" height="100%" horizontalAlign="center" verticalAlign="middle">
			
			<s:List id="lst_oe" width="80%" height="75%" dataProvider="{ar}"/>
			<s:Spacer width="10" height="10"/>
			<s:Button id="btn_getOEInfo" label="OutlookExpressの情報を取得"
					  click="btn_getOEInfo_clickHandler(event)" fontWeight="bold"/>
		</s:VGroup>

	</s:Panel>
	
</s:WindowedApplication>
